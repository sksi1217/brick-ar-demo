<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AR –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–ª–∏—Ç–∫–∏ –ø–æ–¥ –∫–∏—Ä–ø–∏—á</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { 
            margin: 0; 
            font-family: Arial, sans-serif;
        }
        
        .ui-panel {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .texture-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .texture-option {
            width: 80px;
            height: 60px;
            border: 2px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            background-size: cover;
        }
        
        .texture-option.active {
            border-color: #007bff;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        button {
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .instruction {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="instruction">
        üì± –ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –ø–ª–æ—Å–∫—É—é –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å (—Å—Ç–µ–Ω—É)
    </div>

    <a-scene 
        embedded 
        arjs="sourceType: webcam; detectionMode: mono; matrixCodeType: 3x3;"
        renderer="logarithmicDepthBuffer: true;"
        vr-mode-ui="enabled: false"
        screenshot="width: 1280; height: 720">
        
        <!-- –ú–∞—Ä–∫–µ—Ä –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π -->
        <a-entity id="wall-entity" position="0 0 0">
            <a-plane 
                id="brick-wall"
                class="clickable"
                position="0 1 -2" 
                rotation="0 0 0" 
                width="2.5" 
                height="1.8" 
                src="#defaultTexture"
                shadow="receive: true">
            </a-plane>
        </a-entity>
        
        <a-entity camera></a-entity>
    </a-scene>

    <div class="ui-panel">
        <div class="texture-grid" id="textureGrid">
            <!-- –¢–µ–∫—Å—Ç—É—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
        </div>
        
        <div class="controls">
            <button onclick="rotateWall()">üîÑ –ü–æ–≤–µ—Ä–Ω—É—Ç—å</button>
            <button onclick="scaleWall(1.1)">‚ûï –£–≤–µ–ª–∏—á–∏—Ç—å</button>
            <button onclick="scaleWall(0.9)">‚ûñ –£–º–µ–Ω—å—à–∏—Ç—å</button>
            <button onclick="captureForShare()">üì∏ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <script>
        // –ö–∞—Ç–∞–ª–æ–≥ —Ç–µ–∫—Å—Ç—É—Ä –ø–ª–∏—Ç–∫–∏
        const brickTextures = [
            { id: 'red_classic', name: '–ö—Ä–∞—Å–Ω—ã–π –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π', url: 'textures/red_classic.jpg', thumb: 'textures/red_classic_thumb.jpg' },
            { id: 'white_modern', name: '–ë–µ–ª—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π', url: 'textures/white_modern.jpg', thumb: 'textures/white_modern_thumb.jpg' },
            { id: 'brown_vintage', name: '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π –≤–∏–Ω—Ç–∞–∂', url: 'textures/brown_vintage.jpg', thumb: 'textures/brown_vintage_thumb.jpg' },
            { id: 'gray_industrial', name: '–°–µ—Ä—ã–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π', url: 'textures/gray_industrial.jpg', thumb: 'textures/gray_industrial_thumb.jpg' },
            { id: 'sand_beige', name: '–ü–µ—Å–æ—á–Ω—ã–π –±–µ–∂–µ–≤—ã–π', url: 'textures/sand_beige.jpg', thumb: 'textures/sand_beige_thumb.jpg' },
            { id: 'black_premium', name: '–ß–µ—Ä–Ω—ã–π –ø—Ä–µ–º–∏—É–º', url: 'textures/black_premium.jpg', thumb: 'textures/black_premium_thumb.jpg' }
        ];

        let currentRotation = 0;
        let currentScale = 1;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function initUI() {
            const textureGrid = document.getElementById('textureGrid');
            
            brickTextures.forEach((texture, index) => {
                const textureOption = document.createElement('div');
                textureOption.className = `texture-option ${index === 0 ? 'active' : ''}`;
                textureOption.style.backgroundImage = `url(${texture.thumb})`;
                textureOption.onclick = () => selectTexture(texture);
                textureOption.title = texture.name;
                
                textureGrid.appendChild(textureOption);
            });
        }

        function selectTexture(texture) {
            const wall = document.getElementById('brick-wall');
            wall.setAttribute('src', texture.url);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ç–µ–∫—Å—Ç—É—Ä—É –≤ UI
            document.querySelectorAll('.texture-option').forEach(opt => {
                opt.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function rotateWall() {
            currentRotation += 90;
            const wall = document.getElementById('brick-wall');
            wall.setAttribute('rotation', `0 0 ${currentRotation}`);
        }

        function scaleWall(factor) {
            currentScale *= factor;
            const wall = document.getElementById('brick-wall');
            wall.setAttribute('width', 2.5 * currentScale);
            wall.setAttribute('height', 1.8 * currentScale);
        }

        function captureForShare() {
            const scene = document.querySelector('a-scene');
            scene.components.screenshot.capture('perspective')
                .then(function (data) {
                    // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                    const link = document.createElement('a');
                    link.download = 'my_brick_wall_design.png';
                    link.href = data;
                    link.click();
                    
                    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —à–∞—Ä–∏–Ω–≥ –≤ —Å–æ—Ü—Å–µ—Ç–∏
                    shareImage(data);
                });
        }

        function shareImage(imageData) {
            // –ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —à–∞—Ä–∏–Ω–≥–∞
            if (navigator.share) {
                navigator.share({
                    title: '–ú–æ–π –¥–∏–∑–∞–π–Ω —Å—Ç–µ–Ω—ã —Å –ø–ª–∏—Ç–∫–æ–π',
                    text: '–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –ø–ª–∏—Ç–∫–∞ –ø–æ–¥ –∫–∏—Ä–ø–∏—á –≤ –º–æ–µ–º –∏–Ω—Ç–µ—Ä—å–µ—Ä–µ!',
                    url: imageData
                });
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = initUI;
    </script>
</body>
</html>
